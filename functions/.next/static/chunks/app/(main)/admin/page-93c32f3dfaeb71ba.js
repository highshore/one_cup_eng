(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[59],{8128:(e,s,n)=>{Promise.resolve().then(n.bind(n,88905))},22661:(e,s,n)=>{"use strict";n.d(s,{Cn:()=>h,IG:()=>p,db:()=>l,j2:()=>c});var t=n(23915),i=n(16203),r=n(35317),o=n(90858),d=n(81427);let a=(0,t.Wp)({apiKey:"AIzaSyBC62vsKGQqdgpyC9RugoHEfh9UcRi2SMA",authDomain:"one-cup-eng.firebaseapp.com",projectId:"one-cup-eng",storageBucket:"one-cup-eng.firebasestorage.app",messagingSenderId:"615807178262",appId:"1:615807178262:web:9a96a5f0d94ae628d74737"}),c=(0,i.xI)(a),l=(0,r.aU)(a),p=(0,o.c7)(a),h=(0,d.Uz)(a,"asia-northeast3")},35695:(e,s,n)=>{"use strict";var t=n(18999);n.o(t,"useParams")&&n.d(s,{useParams:function(){return t.useParams}}),n.o(t,"usePathname")&&n.d(s,{usePathname:function(){return t.usePathname}}),n.o(t,"useRouter")&&n.d(s,{useRouter:function(){return t.useRouter}}),n.o(t,"useSearchParams")&&n.d(s,{useSearchParams:function(){return t.useSearchParams}}),n.o(t,"useServerInsertedHTML")&&n.d(s,{useServerInsertedHTML:function(){return t.useServerInsertedHTML}})},88905:(e,s,n)=>{"use strict";n.d(s,{default:()=>P});var t=n(95155),i=n(12115),r=n(43262),o=n(81427),d=n(22661),a=n(35317),c=n(35695);let l=r.Ay.div.withConfig({componentId:"sc-d657d38a-0"})(["display:flex;flex-direction:column;padding:20px;max-width:1200px;min-width:1200px;margin:0 auto;"]),p=r.Ay.h1.withConfig({componentId:"sc-d657d38a-1"})(["font-size:24px;font-weight:600;margin-bottom:20px;"]),h=r.Ay.button.withConfig({shouldForwardProp:e=>!["isActive","isCompleted","isOpen"].includes(e)}).withConfig({componentId:"sc-d657d38a-2"})(["background-color:#4caf50;color:white;padding:10px 15px;border:none;border-radius:4px;cursor:pointer;font-size:16px;margin-top:20px;&:hover{background-color:#45a049;}&:disabled{background-color:#cccccc;cursor:not-allowed;}"]),u=r.Ay.div.withConfig({componentId:"sc-d657d38a-3"})(["margin-top:20px;padding:15px;border-radius:4px;background-color:#f5f5f5;overflow-x:auto;"]),x=r.Ay.h3.withConfig({componentId:"sc-d657d38a-4"})(["font-size:18px;margin-bottom:10px;"]),g=r.Ay.div.withConfig({componentId:"sc-d657d38a-5"})(["padding:10px;margin-top:15px;border-radius:4px;background-color:",";color:",";"],e=>"success"===e.status?"#dff0d8":"error"===e.status?"#f2dede":"#f5f5f5",e=>"success"===e.status?"#3c763d":"error"===e.status?"#a94442":"#333"),m=r.Ay.div.withConfig({componentId:"sc-d657d38a-6"})(["display:flex;margin-bottom:20px;"]),f=r.Ay.button.withConfig({shouldForwardProp:e=>!["active"].includes(e)}).withConfig({componentId:"sc-d657d38a-7"})(["padding:10px 20px;background-color:",";color:",";border:none;border-radius:4px;margin-right:10px;cursor:pointer;font-size:16px;&:hover{background-color:",";}"],e=>e.active?"#4caf50":"#f1f1f1",e=>e.active?"white":"black",e=>e.active?"#45a049":"#e1e1e1"),j=r.Ay.div.withConfig({componentId:"sc-d657d38a-8"})(["margin-bottom:30px;border-bottom:1px solid #ddd;padding-bottom:20px;"]),b=r.Ay.h2.withConfig({componentId:"sc-d657d38a-9"})(["font-size:20px;margin-bottom:15px;color:#333;"]),y=r.Ay.select.withConfig({componentId:"sc-d657d38a-10"})(["padding:8px 12px;border:1px solid #ddd;border-radius:4px;font-size:16px;margin-right:15px;"]),v=r.Ay.div.withConfig({componentId:"sc-d657d38a-11"})(["display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px;margin-top:20px;"]),C=r.Ay.div.withConfig({componentId:"sc-d657d38a-12"})(["display:flex;flex-direction:column;gap:15px;margin-top:20px;max-width:800px;"]),w=r.Ay.div.withConfig({componentId:"sc-d657d38a-13"})(["background-color:#fff;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,0.1);padding:15px;transition:all 0.3s ease;&:hover{box-shadow:0 4px 8px rgba(0,0,0,0.15);transform:translateY(-2px);}"]),k=(0,r.Ay)(w).withConfig({componentId:"sc-d657d38a-14"})(["cursor:pointer;"]),S=r.Ay.h4.withConfig({componentId:"sc-d657d38a-15"})(["font-size:18px;font-weight:600;margin-bottom:10px;color:#333;"]),I=r.Ay.div.withConfig({componentId:"sc-d657d38a-16"})(["font-size:14px;color:#555;"]),A=r.Ay.button.withConfig({componentId:"sc-d657d38a-17"})(["background-color:#2196f3;color:white;padding:6px 12px;border:none;border-radius:4px;cursor:pointer;font-size:14px;margin-top:10px;&:hover{background-color:#0b7dda;}"]),_=r.Ay.button.withConfig({componentId:"sc-d657d38a-18"})(["background-color:#4caf50;color:white;padding:6px 12px;border:none;border-radius:4px;cursor:pointer;font-size:14px;margin-right:10px;"]),F=r.Ay.button.withConfig({componentId:"sc-d657d38a-19"})(["background-color:#f44336;color:white;padding:6px 12px;border:none;border-radius:4px;cursor:pointer;font-size:14px;"]),U=r.Ay.input.withConfig({componentId:"sc-d657d38a-20"})(["padding:8px;margin:5px 0;border:1px solid #ddd;border-radius:4px;width:100%;"]),D=r.Ay.div.withConfig({componentId:"sc-d657d38a-21"})(["display:flex;align-items:center;margin:5px 0;input{margin-right:8px;}"]),E=r.Ay.div.withConfig({componentId:"sc-d657d38a-22"})(["margin-top:15px;padding-top:15px;border-top:1px solid #eee;"]),L=r.Ay.div.withConfig({componentId:"sc-d657d38a-23"})(["display:flex;gap:10px;margin-top:15px;"]),N=(0,o.Uz)(d.j2.app,"asia-northeast3");function P(){let e=(0,c.useRouter)(),s=d.j2.currentUser,[n,r]=(0,i.useState)(!1),[P,T]=(0,i.useState)(null),[z,R]=(0,i.useState)("idle"),[M,B]=(0,i.useState)("links"),[G,H]=(0,i.useState)([]),[O,J]=(0,i.useState)([]),[K,Q]=(0,i.useState)(!1),[q,W]=(0,i.useState)(!1),[Y,Z]=(0,i.useState)({}),[V,X]=(0,i.useState)({}),[$,ee]=(0,i.useState)(null),[es,en]=(0,i.useState)(!1),[et,ei]=(0,i.useState)(null),[er,eo]=(0,i.useState)("tech"),[ed,ea]=(0,i.useState)(!1),[ec,el]=(0,i.useState)(!0),[ep,eh]=(0,i.useState)(!1);(0,i.useEffect)(()=>{if((null==s?void 0:s.phoneNumber)!=="+821068584123"&&(null==s?void 0:s.phoneNumber)!=="+821045340406")return void e.push("/profile");eh(!0)},[null==s?void 0:s.phoneNumber,e]),(0,i.useEffect)(()=>{"articles"===M&&0===G.length&&eu(),"users"===M&&0===O.length&&ex()},[M,G.length,O.length]);let eu=async()=>{Q(!0);try{let e=(0,a.rJ)(d.db,"articles"),s=(await (0,a.GG)(e)).docs.map(e=>({id:e.id,...e.data()})).sort((e,s)=>{var n,t,i,r;let o=(null==(t=e.timestamp)||null==(n=t.toDate)?void 0:n.call(t))?e.timestamp.toDate():new Date(0);return((null==(r=s.timestamp)||null==(i=r.toDate)?void 0:i.call(r))?s.timestamp.toDate():new Date(0)).getTime()-o.getTime()});H(s)}catch(e){console.error("Error fetching articles:",e)}finally{Q(!1)}},ex=async()=>{W(!0);try{let e=(0,a.rJ)(d.db,"users"),s=(await (0,a.GG)(e)).docs.map(e=>({id:e.id,...e.data()}));J(s),await eg(s.map(e=>e.id))}catch(e){console.error("Error fetching users:",e)}finally{W(!1)}},eg=async e=>{try{let s=(0,o.Qg)(N,"getUserDisplayNames"),n=(await s({userIds:e})).data;Z(n.displayNames),X(n.phoneNumbers)}catch(e){console.error("Error fetching user data:",e)}},em=async()=>{r(!0),R("idle");try{let e=(0,o.Qg)(N,"testSendLinksToUsers"),s=await e();T(s.data),R("success"),console.log("Function result:",s.data)}catch(e){console.error("Error calling function:",e),T(e),R("error")}finally{r(!1)}},ef=async()=>{ea(!0),R("idle");try{let e=(0,o.Qg)(N,"sendLinksToCategory"),s=await e({category:er,testMode:ec});T(s.data),R("success"),console.log("Function result:",s.data)}catch(e){console.error("Error calling function:",e),T(e),R("error")}finally{ea(!1)}},ej=e=>{ee({id:e.id,name:e.name||"",cat_tech:e.cat_tech||!1,cat_business:e.cat_business||!1}),ei(null)},eb=()=>{ee(null),ei(null)},ey=async()=>{if($){en(!0),ei(null);try{let e=(0,a.H9)(d.db,"users",$.id);await (0,a.mZ)(e,{name:$.name,cat_tech:$.cat_tech,cat_business:$.cat_business}),J(O.map(e=>e.id===$.id?{...e,...$}:e)),ee(null)}catch(e){console.error("Error updating user:",e),ei("Failed to update user. Please try again.")}finally{en(!1)}}},ev=e=>{if(!$)return;let{name:s,value:n,type:t,checked:i}=e.target;ee(e=>e?"checkbox"===t?{...e,[s]:i}:{...e,[s]:n}:e)};return ep?(0,t.jsxs)(l,{children:[(0,t.jsx)(p,{children:"Admin Panel"}),(0,t.jsxs)(m,{children:[(0,t.jsx)(f,{active:"links"===M,onClick:()=>B("links"),children:"Send Links"}),(0,t.jsx)(f,{active:"articles"===M,onClick:()=>B("articles"),children:"Articles"}),(0,t.jsx)(f,{active:"users"===M,onClick:()=>B("users"),children:"Users"})]}),(0,t.jsxs)("div",{style:{width:"100%"},children:["links"===M&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(j,{children:[(0,t.jsx)(b,{children:"Test Send to All Users"}),(0,t.jsx)(h,{onClick:em,disabled:n,children:n?"Sending...":"Test Send Links to Users"})]}),(0,t.jsxs)(j,{children:[(0,t.jsx)(b,{children:"Send to Specific Category"}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"15px"},children:[(0,t.jsxs)(y,{value:er,onChange:e=>eo(e.target.value),children:[(0,t.jsx)("option",{value:"tech",children:"Tech"}),(0,t.jsx)("option",{value:"business",children:"Business"})]}),(0,t.jsxs)(D,{style:{margin:"0 15px"},children:[(0,t.jsx)("input",{type:"checkbox",checked:ec,onChange:e=>el(e.target.checked),id:"testModeCheckbox"}),(0,t.jsx)("label",{htmlFor:"testModeCheckbox",style:{marginLeft:"8px"},children:"Test Mode (only test users)"})]}),(0,t.jsx)(h,{onClick:ef,disabled:ed,children:ed?"Sending...":"Send to ".concat(er," subscribers")})]})]}),P&&(0,t.jsxs)(u,{children:[(0,t.jsx)(x,{children:"Function Result:"}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Status:"})," ",P.success?"Success":"Failed"]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Message:"})," ",P.message]}),(0,t.jsx)(g,{status:z,children:"success"===z?"Successfully sent messages!":"error"===z?"Error sending messages":""}),P&&P.stats?"techCount"in P.stats||"businessCount"in P.stats?(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{children:["Tech recipients: ",P.stats.techCount||0]}),(0,t.jsxs)("p",{children:["Business recipients: ",P.stats.businessCount||0]}),(0,t.jsxs)("p",{children:["Expiry notifications: ",P.stats.expiryCount||0]})]}):"recipientCount"in P.stats?(0,t.jsx)("div",{children:(0,t.jsxs)("p",{children:[er.charAt(0).toUpperCase()+er.slice(1)," ","recipients: ",P.stats.recipientCount]})}):(0,t.jsx)("pre",{children:JSON.stringify(P.stats,null,2)}):null,(0,t.jsx)("div",{style:{marginTop:"15px"},children:(0,t.jsxs)("details",{children:[(0,t.jsx)("summary",{children:"Response Details"}),(0,t.jsx)("pre",{style:{maxHeight:"250px",overflow:"auto"},children:JSON.stringify(P,null,2)})]})})]})]}),"articles"===M&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h,{onClick:eu,disabled:K,children:K?"Loading...":"Refresh Articles"}),K?(0,t.jsx)("p",{children:"Loading articles..."}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(x,{children:["Articles (",G.length,")"]}),(0,t.jsx)(C,{children:G.map(s=>{var n,i,r,o;return(0,t.jsxs)(k,{onClick:()=>{e.push("/article/".concat(s.id))},children:[(0,t.jsx)(S,{children:(null==(n=s.title)?void 0:n.english)||"Untitled"}),(0,t.jsxs)(I,{children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"ID:"})," ",s.id]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Korean Title:"})," ",(null==(i=s.title)?void 0:i.korean)||"No Korean title"]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Date:"})," ",(null==(o=s.timestamp)||null==(r=o.toDate)?void 0:r.call(o))?s.timestamp.toDate().toLocaleDateString():"No date"]})]})]},s.id)})})]})]}),"users"===M&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h,{onClick:ex,disabled:q,children:q?"Loading...":"Refresh Users"}),q?(0,t.jsx)("p",{children:"Loading users..."}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(x,{children:["Users (",O.length,")"]}),(0,t.jsx)(v,{children:O.map(e=>{let s=Y[e.id]||"",n=V[e.id]||"",i=(null==$?void 0:$.id)===e.id;return(0,t.jsxs)(w,{children:[(0,t.jsx)(S,{children:s||e.display_name||"Unnamed User"}),(0,t.jsxs)(I,{children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"ID:"})," ",e.id]}),n&&(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Phone:"})," ",n]}),e.phone&&(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Firestore Phone:"})," ",e.phone]}),e.email&&(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Email:"})," ",e.email]}),i?(0,t.jsxs)(E,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{children:"Name:"}),(0,t.jsx)(U,{type:"text",name:"name",value:$.name,onChange:ev})]}),(0,t.jsxs)(D,{children:[(0,t.jsx)("input",{type:"checkbox",name:"cat_tech",checked:$.cat_tech,onChange:ev,id:"cat_tech"}),(0,t.jsx)("label",{htmlFor:"cat_tech",children:"Tech Category"})]}),(0,t.jsxs)(D,{children:[(0,t.jsx)("input",{type:"checkbox",name:"cat_business",checked:$.cat_business,onChange:ev,id:"cat_business"}),(0,t.jsx)("label",{htmlFor:"cat_business",children:"Business Category"})]}),et&&(0,t.jsx)("p",{style:{color:"red"},children:et}),(0,t.jsxs)(L,{children:[(0,t.jsx)(_,{onClick:ey,disabled:es,children:es?"Saving...":"Save"}),(0,t.jsx)(F,{onClick:eb,disabled:es,children:"Cancel"})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Name:"})," ",e.name||"N/A"]}),e.cat_tech&&(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Category:"})," Tech"]}),e.cat_business&&(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Category:"})," Business"]}),e.last_received&&(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Last Received:"})," ",e.last_received.toDate().toLocaleString()]}),e.received_articles&&e.received_articles.length>0&&(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Received Articles:"})," ",e.received_articles.length]}),(0,t.jsx)(A,{onClick:()=>ej(e),children:"Edit User"})]})]})]},e.id)})})]})]})]})]}):(0,t.jsx)(l,{children:(0,t.jsx)(p,{children:"Loading..."})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[992,888,262,432,441,964,358],()=>s(8128)),_N_E=e.O()}]);
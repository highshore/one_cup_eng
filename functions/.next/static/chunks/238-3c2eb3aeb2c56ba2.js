"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[238],{22661:(e,t,r)=>{r.d(t,{Cn:()=>p,IG:()=>m,db:()=>c,j2:()=>d});var n=r(23915),o=r(16203),a=r(35317),i=r(90858),s=r(81427);let l=(0,n.Wp)({apiKey:"AIzaSyBC62vsKGQqdgpyC9RugoHEfh9UcRi2SMA",authDomain:"one-cup-eng.firebaseapp.com",projectId:"one-cup-eng",storageBucket:"one-cup-eng.firebasestorage.app",messagingSenderId:"615807178262",appId:"1:615807178262:web:9a96a5f0d94ae628d74737"}),d=(0,o.xI)(l),c=(0,a.aU)(l),m=(0,i.c7)(l),p=(0,s.Uz)(l,"asia-northeast3")},25193:(e,t,r)=>{r.d(t,{c:()=>H});var n=r(95155),o=r(12115),a=r(43262),i=r(90858),s=r(22661);let l=e=>{let t=Date.now(),r=Math.random().toString(36).substring(2,15),n=e.split(".").pop()||"jpg";return"".concat(t,"_").concat(r,".").concat(n)},d=async e=>{try{if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(e.type))throw Error("Only JPEG, PNG, and WebP images are allowed");if(e.size>5242880)throw Error("Image size must be less than 5MB");let t=l(e.name),r=(0,i.KR)(s.IG,"blog/".concat(t)),n=await (0,i.D)(r,e),o=await (0,i.qk)(n.ref);return console.log("Blog image uploaded successfully:",o),o}catch(e){throw console.error("Error uploading blog image:",e),e}},c=e=>{let t=[],r=[],n=Array.from(e),o=["image/jpeg","image/jpg","image/png","image/webp"];return n.forEach((e,n)=>o.includes(e.type)?e.size>5242880?void r.push("File ".concat(n+1,": Image size must be less than 5MB")):void t.push(e):void r.push("File ".concat(n+1,": Only JPEG, PNG, and WebP images are allowed"))),{valid:t,errors:r}},m={primary:"#2C1810",primaryLight:"#4A2F23",primaryPale:"#F5EBE6",primaryBg:"#FDF9F6",accent:"#C8A27A",text:{dark:"#2C1810",medium:"#4A2F23",light:"#8B6B4F"}},p=a.Ay.div.withConfig({componentId:"sc-e274f75c-0"})(["position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;z-index:1000;padding:1rem;overflow-y:auto;"]),g=a.Ay.div.withConfig({componentId:"sc-e274f75c-1"})(['background:white;border-radius:16px;width:100%;max-width:800px;max-height:90vh;overflow-y:auto;box-shadow:0 16px 48px rgba(0,0,0,0.2);font-family:"Noto Sans KR",sans-serif;@media (max-width:768px){max-height:95vh;border-radius:14px;}']),u=a.Ay.div.withConfig({componentId:"sc-e274f75c-2"})(["padding:1.25rem 1.75rem;border-bottom:1px solid ",";background:",";border-radius:16px 16px 0 0;@media (max-width:768px){padding:1rem 1.25rem;border-radius:14px 14px 0 0;}"],m.primaryPale,m.primaryBg),h=a.Ay.h2.withConfig({componentId:"sc-e274f75c-3"})(["font-size:1.4rem;font-weight:700;color:",';margin:0;font-family:"Noto Sans KR",sans-serif;@media (max-width:768px){font-size:1.2rem;}'],m.text.dark),f=a.Ay.form.withConfig({componentId:"sc-e274f75c-4"})(["padding:1.5rem;@media (max-width:768px){padding:1.25rem;}"]),x=a.Ay.div.withConfig({componentId:"sc-e274f75c-5"})(["margin-bottom:1.25rem;@media (max-width:768px){margin-bottom:1rem;}"]),b=a.Ay.label.withConfig({componentId:"sc-e274f75c-6"})(["display:block;font-size:0.85rem;font-weight:600;color:",';margin-bottom:0.4rem;font-family:"Noto Sans KR",sans-serif;'],m.text.dark),y=a.Ay.input.withConfig({componentId:"sc-e274f75c-7"})(["width:100%;padding:0.6rem 0.8rem;border:2px solid ",";border-radius:10px;font-size:0.95rem;color:",';background:white;transition:all 0.2s ease;box-sizing:border-box;font-family:"Noto Sans KR",sans-serif;&:focus{outline:none;border-color:',";box-shadow:0 0 0 3px rgba(200,162,122,0.1);}&::placeholder{color:",";}@media (max-width:768px){padding:0.5rem 0.7rem;font-size:0.9rem;border-radius:8px;}"],m.primaryPale,m.text.dark,m.accent,m.text.light),w=a.Ay.textarea.withConfig({componentId:"sc-e274f75c-8"})(["width:100%;min-height:100px;padding:0.6rem 0.8rem;border:2px solid ",";border-radius:10px;font-size:0.85rem;color:",';background:white;transition:all 0.2s ease;resize:vertical;font-family:"Noto Sans KR",sans-serif;line-height:1.5;box-sizing:border-box;&:focus{outline:none;border-color:',";box-shadow:0 0 0 3px rgba(200,162,122,0.1);}&::placeholder{color:",";}@media (max-width:768px){padding:0.5rem 0.7rem;font-size:0.8rem;min-height:80px;border-radius:8px;}"],m.primaryPale,m.text.dark,m.accent,m.text.light),v=a.Ay.textarea.withConfig({componentId:"sc-e274f75c-9"})(["width:100%;min-height:280px;padding:0.8rem;border:2px solid ",";border-radius:10px;font-size:0.95rem;color:",';background:white;transition:all 0.2s ease;resize:vertical;font-family:"Noto Sans KR",sans-serif;line-height:1.6;box-sizing:border-box;&:focus{outline:none;border-color:',";box-shadow:0 0 0 3px rgba(200,162,122,0.1);}&::placeholder{color:",";}@media (max-width:768px){padding:0.7rem;font-size:0.9rem;min-height:220px;border-radius:8px;}"],m.primaryPale,m.text.dark,m.accent,m.text.light),j=a.Ay.select.withConfig({componentId:"sc-e274f75c-10"})(["width:100%;padding:0.6rem 0.8rem;border:2px solid ",";border-radius:10px;font-size:0.95rem;color:",';background:white;transition:all 0.2s ease;box-sizing:border-box;font-family:"Noto Sans KR",sans-serif;&:focus{outline:none;border-color:',";box-shadow:0 0 0 3px rgba(200,162,122,0.1);}@media (max-width:768px){padding:0.5rem 0.7rem;font-size:0.9rem;border-radius:8px;}"],m.primaryPale,m.text.dark,m.accent),I=(0,a.Ay)(y).withConfig({componentId:"sc-e274f75c-11"})(["&::placeholder{color:",";}"],m.text.light),k=a.Ay.div.withConfig({componentId:"sc-e274f75c-12"})(["display:grid;grid-template-columns:1fr 1fr;gap:0.8rem;@media (max-width:768px){grid-template-columns:1fr;gap:0.6rem;}"]),C=a.Ay.div.withConfig({componentId:"sc-e274f75c-13"})(["display:flex;gap:0.8rem;justify-content:flex-end;margin-top:1.5rem;padding-top:1.25rem;border-top:1px solid ",";@media (max-width:768px){flex-direction:column-reverse;gap:0.6rem;margin-top:1.25rem;padding-top:1rem;}"],m.primaryPale),A=a.Ay.button.withConfig({componentId:"sc-e274f75c-14"})(['padding:0.6rem 1.25rem;border:none;border-radius:25px;font-size:0.95rem;font-weight:600;font-family:"Noto Sans KR",sans-serif;cursor:pointer;transition:all 0.3s ease;min-width:110px;'," &:active{transform:translateY(0);}&:disabled{opacity:0.6;cursor:not-allowed;transform:none;}@media (max-width:768px){padding:0.5rem 1rem;font-size:0.9rem;min-width:90px;}"],e=>{switch(e.$variant){case"primary":return"\n          background: ".concat(m.primary,";\n          color: white;\n          box-shadow: 0 4px 12px rgba(44, 24, 16, 0.2);\n          \n          &:hover {\n            background: ").concat(m.primaryLight,";\n            transform: translateY(-2px);\n            box-shadow: 0 6px 20px rgba(44, 24, 16, 0.3);\n          }\n        ");case"danger":return"\n          background: #ef4444;\n          color: white;\n          box-shadow: 0 4px 12px rgba(239, 68, 68, 0.2);\n          \n          &:hover {\n            background: #dc2626;\n            transform: translateY(-2px);\n            box-shadow: 0 6px 20px rgba(239, 68, 68, 0.3);\n          }\n        ";default:return"\n          background: ".concat(m.primaryPale,";\n          color: ").concat(m.text.dark,";\n          \n          &:hover {\n            background: ").concat(m.accent,";\n            color: white;\n            transform: translateY(-2px);\n          }\n        ")}}),S=a.Ay.div.withConfig({componentId:"sc-e274f75c-15"})(["text-align:right;font-size:0.75rem;color:",';margin-top:0.2rem;font-family:"Noto Sans KR",sans-serif;'],m.text.light),E=a.Ay.div.withConfig({componentId:"sc-e274f75c-16"})(["font-size:0.75rem;color:",';margin-top:0.2rem;line-height:1.4;font-family:"Noto Sans KR",sans-serif;'],m.text.light),z=a.Ay.button.withConfig({componentId:"sc-e274f75c-17"})(["padding:0.6rem 0.8rem;background:",';color:white;border:none;border-radius:8px;font-size:0.85rem;font-weight:600;font-family:"Noto Sans KR",sans-serif;cursor:pointer;transition:all 0.2s ease;white-space:nowrap;display:flex;align-items:center;gap:0.4rem;min-width:110px;justify-content:center;&:hover{background:',";transform:translateY(-1px);}&:disabled{opacity:0.6;cursor:not-allowed;transform:none;}@media (max-width:768px){padding:0.5rem 0.7rem;font-size:0.8rem;min-width:90px;gap:0.3rem;}"],m.accent,m.primaryLight),D=a.Ay.input.withConfig({componentId:"sc-e274f75c-18"})(["display:none;"]),P=a.Ay.div.withConfig({componentId:"sc-e274f75c-19"})(["margin-top:0.4rem;display:flex;align-items:center;gap:0.4rem;img{width:50px;height:50px;object-fit:cover;border-radius:6px;border:1px solid ",";}@media (max-width:768px){margin-top:0.3rem;gap:0.3rem;img{width:40px;height:40px;border-radius:5px;}}"],m.primaryPale),F=a.Ay.button.withConfig({componentId:"sc-e274f75c-20"})(["background:#ef4444;color:white;border:none;border-radius:50%;width:24px;height:24px;cursor:pointer;font-size:12px;display:flex;align-items:center;justify-content:center;transition:all 0.2s ease;&:hover{background:#dc2626;transform:scale(1.1);}"]),R=a.Ay.div.withConfig({componentId:"sc-e274f75c-21"})(["display:flex;gap:0.5rem;margin-bottom:0.5rem;flex-wrap:wrap;@media (max-width:768px){gap:0.375rem;}"]),B=a.Ay.div.withConfig({componentId:"sc-e274f75c-22"})(["display:flex;gap:0.5rem;align-items:center;margin-bottom:0.5rem;flex-wrap:wrap;padding:0.5rem;background:",";border-radius:8px;@media (max-width:768px){gap:0.4rem;padding:0.4rem;}"],m.primaryBg),N=a.Ay.button.withConfig({componentId:"sc-e274f75c-23"})(["background:",";color:",";border:1px solid ",';border-radius:6px;padding:0.4rem 0.6rem;font-size:0.85rem;font-weight:600;font-family:"Noto Sans KR",sans-serif;cursor:pointer;transition:all 0.2s ease;display:flex;align-items:center;gap:0.3rem;&:hover{background:',";}&:disabled{opacity:0.5;cursor:not-allowed;}@media (max-width:768px){padding:0.3rem 0.5rem;font-size:0.8rem;}"],e=>e.$active?m.accent:"white",e=>e.$active?"white":m.text.dark,m.primaryPale,e=>e.$active?m.primaryLight:m.primaryPale),T=a.Ay.div.withConfig({componentId:"sc-e274f75c-24"})(["display:flex;flex-direction:column;gap:0.5rem;"]),K=a.Ay.button.withConfig({componentId:"sc-e274f75c-25"})(["padding:0.5rem 0.75rem;background:",";color:",";border:none;border-radius:6px;font-size:0.8rem;font-weight:600;cursor:pointer;transition:all 0.2s ease;display:flex;align-items:center;gap:0.375rem;&:hover{background:",";color:white;}&:disabled{opacity:0.6;cursor:not-allowed;}@media (max-width:768px){padding:0.4rem 0.6rem;font-size:0.75rem;}"],m.primaryPale,m.text.dark,m.accent),G=a.Ay.div.withConfig({componentId:"sc-e274f75c-26"})(["margin-top:0.5rem;padding:0.5rem;background:",";border-radius:6px;font-size:0.8rem;color:",";border:1px solid ",";"],m.primaryBg,m.text.medium,m.primaryPale),H=e=>{let{post:t,onSave:r,onCancel:a}=e,[i,s]=(0,o.useState)({title:"",content:"",excerpt:"",status:"draft",featuredImage:"",tags:""}),[l,m]=(0,o.useState)(!1),[H,L]=(0,o.useState)(!1),[M,_]=(0,o.useState)(""),$=(0,o.useRef)(null),J=(0,o.useRef)(null);(0,o.useEffect)(()=>{if(t){var e;s({title:t.title||"",content:t.content||"",excerpt:t.excerpt||"",status:t.status||"draft",featuredImage:t.featuredImage||"",tags:(null==(e=t.tags)?void 0:e.join(", "))||""})}},[t]);let U=e=>{let{name:t,value:r}=e.target;s(e=>({...e,[t]:r}))},Y=async e=>{if(e.preventDefault(),!i.title.trim())return void alert("제목을 입력해주세요.");if(!i.content.trim())return void alert("내용을 입력해주세요.");m(!0);try{let e={title:i.title.trim(),content:i.content.trim(),status:i.status};if(i.excerpt.trim()&&(e.excerpt=i.excerpt.trim()),i.featuredImage.trim()&&(e.featuredImage=i.featuredImage.trim()),i.tags.trim()){let t=i.tags.split(",").map(e=>e.trim()).filter(e=>e.length>0);t.length>0&&(e.tags=t)}console.log("Submitting blog post data:",e),await r(e)}catch(e){console.error("Failed to save post:",e),alert("저장에 실패했습니다. 다시 시도해주세요.")}finally{m(!1)}},q=async e=>{let t=e.target.files;if(!t||0===t.length)return;let{valid:r,errors:n}=c(t);if(n.length>0)return void alert("이미지 업로드 오류:\n"+n.join("\n"));if(0!==r.length)try{L(!0),_("대표 이미지 업로드 중...");let e=await d(r[0]);s(t=>({...t,featuredImage:e})),_("")}catch(e){console.error("Featured image upload failed:",e),alert("이미지 업로드에 실패했습니다: "+(e instanceof Error?e.message:String(e)))}finally{L(!1),$.current&&($.current.value="")}},W=async e=>{let t=e.target.files;if(!t||0===t.length)return;let{valid:r,errors:n}=c(t);if(n.length>0)return void alert("이미지 업로드 오류:\n"+n.join("\n"));if(0!==r.length)try{L(!0),_("컨텐츠 이미지 업로드 중...");let e=await d(r[0]),t="\n![이미지 설명](".concat(e,")\n"),n=document.getElementById("content");if(n){let e=n.selectionStart,r=n.selectionEnd,o=i.content,a=o.substring(0,e)+t+o.substring(r);s(e=>({...e,content:a})),setTimeout(()=>{n.focus(),n.setSelectionRange(e+t.length,e+t.length)},100)}else s(e=>({...e,content:e.content+t}));_("")}catch(e){console.error("Content image upload failed:",e),alert("이미지 업로드에 실패했습니다: "+(e instanceof Error?e.message:String(e)))}finally{L(!1),J.current&&(J.current.value="")}},O=e=>{let t=document.getElementById("content");if(t){let r=t.scrollTop,n=t.selectionStart,o=t.selectionEnd,a=i.content,l=a.substring(n,o);if(!l)return;let d="";"bold"===e?d="**".concat(l,"**"):"crimson"===e&&(d='<span style="color: crimson; font-weight: bold;">'.concat(l,"</span>"));let c=a.substring(0,n)+d+a.substring(o);s(e=>({...e,content:c})),setTimeout(()=>{let e=n+d.length;t.setSelectionRange(e,e),t.scrollTop=r,t.focus()},50)}};return(0,n.jsx)(p,{onClick:e=>{e.target===e.currentTarget&&a()},children:(0,n.jsxs)(g,{children:[(0,n.jsx)(u,{children:(0,n.jsx)(h,{children:t?"포스트 편집":"새 포스트 작성"})}),(0,n.jsxs)(f,{onSubmit:Y,children:[(0,n.jsxs)(x,{children:[(0,n.jsx)(b,{htmlFor:"title",children:"제목 *"}),(0,n.jsx)(y,{id:"title",name:"title",type:"text",value:i.title,onChange:U,placeholder:"블로그 포스트 제목을 입력하세요",required:!0}),(0,n.jsxs)(S,{children:[i.title.length,"/100"]})]}),(0,n.jsxs)(x,{children:[(0,n.jsx)(b,{htmlFor:"excerpt",children:"요약"}),(0,n.jsx)(w,{id:"excerpt",name:"excerpt",value:i.excerpt,onChange:U,placeholder:"포스트의 간단한 요약을 작성하세요 (선택사항)",rows:3}),(0,n.jsxs)(S,{children:[i.excerpt.length,"/300"]})]}),(0,n.jsxs)(x,{children:[(0,n.jsx)(b,{htmlFor:"content",children:"내용 *"}),(0,n.jsxs)(R,{children:[(0,n.jsx)(K,{type:"button",onClick:()=>{let e=document.getElementById("content");if(e){let t=e.scrollTop,r=e.selectionStart,n=e.selectionEnd,o=i.content,a=o.substring(0,r),l=""===a||a.endsWith("\n")?"# ":"\n# ",d=o.substring(0,r)+l+o.substring(n);s(e=>({...e,content:d})),setTimeout(()=>{e.setSelectionRange(r+l.length,r+l.length),e.scrollTop=t,e.focus()},50)}},disabled:H,children:"\uD83D\uDCDD 헤더 삽입"}),(0,n.jsx)(K,{type:"button",onClick:()=>{var e;null==(e=J.current)||e.click()},disabled:H,children:"\uD83D\uDDBC️ 이미지 삽입"}),(0,n.jsx)(E,{style:{margin:0,fontSize:"0.75rem"},children:"헤더는 '# ' 형식으로, 이미지는 마크다운 형식으로 커서 위치에 삽입됩니다"})]}),(0,n.jsxs)(B,{children:[(0,n.jsxs)(N,{type:"button",onClick:()=>O("bold"),disabled:H,title:"굵은 텍스트",children:[(0,n.jsx)("strong",{children:"B"}),"굵게"]}),(0,n.jsxs)(N,{type:"button",onClick:()=>O("crimson"),disabled:H,title:"빨간 굵은 텍스트",style:{color:"crimson"},children:[(0,n.jsx)("strong",{style:{color:"crimson"},children:"A"}),"빨간색"]}),(0,n.jsx)(E,{style:{margin:0,fontSize:"0.75rem"},children:"텍스트를 선택한 후 버튼을 클릭하거나, 버튼을 클릭하여 서식을 삽입하세요"})]}),(0,n.jsx)(v,{id:"content",name:"content",value:i.content,onChange:U,placeholder:"여기에 블로그 포스트 내용을 작성하세요...",required:!0}),(0,n.jsxs)(S,{children:[i.content.length," 글자"]}),(0,n.jsx)(D,{ref:J,type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:W})]}),(0,n.jsxs)(k,{children:[(0,n.jsxs)(x,{children:[(0,n.jsx)(b,{htmlFor:"status",children:"상태"}),(0,n.jsxs)(j,{id:"status",name:"status",value:i.status,onChange:U,children:[(0,n.jsx)("option",{value:"draft",children:"초안"}),(0,n.jsx)("option",{value:"published",children:"발행"})]})]}),(0,n.jsxs)(x,{children:[(0,n.jsx)(b,{children:"대표 이미지"}),(0,n.jsxs)(T,{children:[(0,n.jsx)(z,{type:"button",onClick:()=>{var e;null==(e=$.current)||e.click()},disabled:H,children:"\uD83D\uDCC1 파일 선택"}),i.featuredImage&&(0,n.jsxs)(P,{children:[(0,n.jsx)("img",{src:i.featuredImage,alt:"대표 이미지 미리보기"}),(0,n.jsx)(F,{type:"button",onClick:()=>{s(e=>({...e,featuredImage:""}))},title:"이미지 제거",children:"✕"})]}),(0,n.jsx)(D,{ref:$,type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:q})]})]})]}),(0,n.jsxs)(x,{children:[(0,n.jsx)(b,{htmlFor:"tags",children:"태그"}),(0,n.jsx)(I,{id:"tags",name:"tags",type:"text",value:i.tags,onChange:U,placeholder:"태그를 쉼표로 구분하여 입력하세요 (예: 영어학습, 비즈니스, 팁)"}),(0,n.jsx)(E,{children:"태그는 쉼표(,)로 구분하여 입력해주세요. 독자들이 관련 포스트를 찾는데 도움이 됩니다."})]}),M&&(0,n.jsx)(G,{children:M}),(0,n.jsxs)(C,{children:[(0,n.jsx)(A,{type:"button",onClick:a,disabled:H,children:"취소"}),(0,n.jsx)(A,{type:"submit",$variant:"primary",disabled:l||H,children:l?"저장 중...":H?"업로드 중...":t?"수정하기":"발행하기"})]})]})]})})}},35695:(e,t,r)=>{var n=r(18999);r.o(n,"useParams")&&r.d(t,{useParams:function(){return n.useParams}}),r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}}),r.o(n,"useServerInsertedHTML")&&r.d(t,{useServerInsertedHTML:function(){return n.useServerInsertedHTML}})},62269:(e,t,r)=>{r.d(t,{A:()=>d,default:()=>c});var n=r(95155),o=r(12115),a=r(16203),i=r(22661),s=r(35317);let l=(0,o.createContext)({currentUser:null,isLoading:!0,hasActiveSubscription:null,accountStatus:null,logout:async()=>{}}),d=()=>(0,o.useContext)(l),c=e=>{let{children:t}=e,[r,d]=(0,o.useState)(null),[c,m]=(0,o.useState)(!0),[p,g]=(0,o.useState)(null),[u,h]=(0,o.useState)(null);(0,o.useEffect)(()=>(0,a.hg)(i.j2,async e=>{if(d(e),e)try{let t=(0,s.H9)(i.db,"users",e.uid),r=await (0,s.x7)(t);if(r.exists()){let e=r.data();g(e.hasActiveSubscription||!1),h(e.account_status||"user")}else g(!1),h("user")}catch(e){console.error("Error fetching user data:",e),g(!1),h("user")}else g(null),h(null);m(!1)}),[]);let f=async()=>{await (0,a.CI)(i.j2)};return(0,n.jsx)(l.Provider,{value:{currentUser:r,isLoading:c,hasActiveSubscription:p,accountStatus:u,logout:f},children:t})}},75768:(e,t,r)=>{r.d(t,{$r:()=>d,CF:()=>l,Fd:()=>p,TB:()=>c,ZA:()=>m,m0:()=>u,s2:()=>g});var n=r(35317),o=r(22661);let a="blog_posts",i=e=>e.toLowerCase().replace(/[^a-z0-9\s]/g,"").replace(/\s+/g,"-").trim(),s=e=>{var t,r,n;let o=e.data();return{id:e.id,title:o.title||"",content:o.content||"",excerpt:o.excerpt||"",createdAt:(null==(t=o.createdAt)?void 0:t.toDate())||new Date,updatedAt:(null==(r=o.updatedAt)?void 0:r.toDate())||new Date,publishedAt:(null==(n=o.publishedAt)?void 0:n.toDate())||null,status:o.status||"draft",slug:o.slug||"",featuredImage:o.featuredImage||"",tags:o.tags||[],views:o.views||0,likes:o.likes||0,likedBy:o.likedBy||[]}},l=async()=>{try{let e=(0,n.rJ)(o.db,a);return(await (0,n.GG)(e)).docs.map(s).filter(e=>"published"===e.status).sort((e,t)=>{let r=e.publishedAt||e.createdAt;return(t.publishedAt||t.createdAt).getTime()-r.getTime()})}catch(e){return console.error("Error fetching blog posts:",e),[]}},d=async()=>{try{let e=(0,n.rJ)(o.db,a);return(await (0,n.GG)(e)).docs.map(s).sort((e,t)=>t.updatedAt.getTime()-e.updatedAt.getTime())}catch(e){return console.error("Error fetching all blog posts:",e),[]}},c=async e=>{try{let t=(0,n.H9)(o.db,a,e),r=await (0,n.x7)(t);if(r.exists())return s(r);return null}catch(e){throw console.error("Error fetching blog post:",e),Error("Failed to fetch blog post")}},m=async e=>{try{let t=(0,n.H9)(o.db,a,e),r=await (0,n.x7)(t);if(!r.exists())return null;{let e=s(r);if("published"===e.status)return e;return null}}catch(e){throw console.error("Error fetching published blog post:",e),Error("Failed to fetch blog post")}},p=async e=>{try{console.log("Creating blog post with data:",e);let t=new Date,r=i(e.title||""),s={title:e.title||"",content:e.content||"",createdAt:n.Dc.fromDate(t),updatedAt:n.Dc.fromDate(t),publishedAt:"published"===e.status?n.Dc.fromDate(t):null,status:e.status||"draft",slug:r};e.excerpt&&(s.excerpt=e.excerpt),e.featuredImage&&(s.featuredImage=e.featuredImage),e.tags&&e.tags.length>0&&(s.tags=e.tags),console.log("Final blog post object:",s);let l=(0,n.rJ)(o.db,a),d=await (0,n.gS)(l,s);return console.log("Blog post created successfully with ID:",d.id),d.id}catch(e){throw console.error("Error creating blog post:",e),console.error("Error stack:",e instanceof Error?e.stack:"No stack"),Error("Failed to create blog post: "+(e instanceof Error?e.message:String(e)))}},g=async(e,t)=>{try{console.log("Updating blog post ID:",e,"with data:",t);let r=(0,n.H9)(o.db,a,e),s=new Date,l={updatedAt:n.Dc.fromDate(s)};if(void 0!==t.title&&(l.title=t.title,l.slug=i(t.title)),void 0!==t.content&&(l.content=t.content),void 0!==t.excerpt&&(l.excerpt=t.excerpt),void 0!==t.status&&(l.status=t.status),void 0!==t.featuredImage&&(l.featuredImage=t.featuredImage),void 0!==t.tags&&(l.tags=t.tags),"published"===t.status){let e=(await (0,n.x7)(r)).data();(null==e?void 0:e.publishedAt)||(l.publishedAt=n.Dc.fromDate(s))}console.log("Final update data:",l),await (0,n.mZ)(r,l),console.log("Blog post updated successfully")}catch(e){throw console.error("Error updating blog post:",e),console.error("Error stack:",e instanceof Error?e.stack:"No stack"),Error("Failed to update blog post: "+(e instanceof Error?e.message:String(e)))}},u=async e=>{try{let t=(0,n.H9)(o.db,a,e);await (0,n.kd)(t)}catch(e){throw console.error("Error deleting blog post:",e),Error("Failed to delete blog post")}}}}]);
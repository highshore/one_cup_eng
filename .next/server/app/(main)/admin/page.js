(()=>{var e={};e.id=59,e.ids=[59],e.modules={1272:(e,t,s)=>{Promise.resolve().then(s.bind(s,96885))},1944:(e,t,s)=>{Promise.resolve().then(s.bind(s,60159))},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},7250:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>o.a,__next_app__:()=>p,pages:()=>l,routeModule:()=>u,tree:()=>c});var r=s(65239),n=s(48088),i=s(88170),o=s.n(i),d=s(30893),a={};for(let e in d)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(a[e]=()=>d[e]);s.d(t,a);let c={children:["",{children:["(main)",{children:["admin",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,19428)),"/Users/kylekim/Desktop/one_cup_eng/app/(main)/admin/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,19559)),"/Users/kylekim/Desktop/one_cup_eng/app/(main)/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,65284,23)),"next/dist/client/components/unauthorized-error"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,58014)),"/Users/kylekim/Desktop/one_cup_eng/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,l=["/Users/kylekim/Desktop/one_cup_eng/app/(main)/admin/page.tsx"],p={require:s,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/(main)/admin/page",pathname:"/admin",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14985:e=>{"use strict";e.exports=require("dns")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19428:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o,metadata:()=>i});var r=s(37413),n=s(96885);let i={title:"Admin Panel - OneCup English",description:"Admin panel for managing users, articles, and messaging system"};function o(){return(0,r.jsx)(n.default,{})}},19771:e=>{"use strict";e.exports=require("process")},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},55511:e=>{"use strict";e.exports=require("crypto")},60159:(e,t,s)=>{"use strict";s.d(t,{default:()=>E});var r=s(60687),n=s(43210),i=s(4529),o=s(24890),d=s(83503),a=s(75535),c=s(16189);let l=i.Ay.div.withConfig({componentId:"sc-d657d38a-0"})(["display:flex;flex-direction:column;padding:20px;max-width:1200px;min-width:1200px;margin:0 auto;"]),p=i.Ay.h1.withConfig({componentId:"sc-d657d38a-1"})(["font-size:24px;font-weight:600;margin-bottom:20px;"]),u=i.Ay.button.withConfig({shouldForwardProp:e=>!["isActive","isCompleted","isOpen"].includes(e)}).withConfig({componentId:"sc-d657d38a-2"})(["background-color:#4caf50;color:white;padding:10px 15px;border:none;border-radius:4px;cursor:pointer;font-size:16px;margin-top:20px;&:hover{background-color:#45a049;}&:disabled{background-color:#cccccc;cursor:not-allowed;}"]),x=i.Ay.div.withConfig({componentId:"sc-d657d38a-3"})(["margin-top:20px;padding:15px;border-radius:4px;background-color:#f5f5f5;overflow-x:auto;"]),h=i.Ay.h3.withConfig({componentId:"sc-d657d38a-4"})(["font-size:18px;margin-bottom:10px;"]),g=i.Ay.div.withConfig({componentId:"sc-d657d38a-5"})(["padding:10px;margin-top:15px;border-radius:4px;background-color:",";color:",";"],e=>"success"===e.status?"#dff0d8":"error"===e.status?"#f2dede":"#f5f5f5",e=>"success"===e.status?"#3c763d":"error"===e.status?"#a94442":"#333"),m=i.Ay.div.withConfig({componentId:"sc-d657d38a-6"})(["display:flex;margin-bottom:20px;"]),f=i.Ay.button.withConfig({shouldForwardProp:e=>!["active"].includes(e)}).withConfig({componentId:"sc-d657d38a-7"})(["padding:10px 20px;background-color:",";color:",";border:none;border-radius:4px;margin-right:10px;cursor:pointer;font-size:16px;&:hover{background-color:",";}"],e=>e.active?"#4caf50":"#f1f1f1",e=>e.active?"white":"black",e=>e.active?"#45a049":"#e1e1e1"),b=i.Ay.div.withConfig({componentId:"sc-d657d38a-8"})(["margin-bottom:30px;border-bottom:1px solid #ddd;padding-bottom:20px;"]),j=i.Ay.h2.withConfig({componentId:"sc-d657d38a-9"})(["font-size:20px;margin-bottom:15px;color:#333;"]),y=i.Ay.select.withConfig({componentId:"sc-d657d38a-10"})(["padding:8px 12px;border:1px solid #ddd;border-radius:4px;font-size:16px;margin-right:15px;"]),v=i.Ay.div.withConfig({componentId:"sc-d657d38a-11"})(["display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px;margin-top:20px;"]),C=i.Ay.div.withConfig({componentId:"sc-d657d38a-12"})(["display:flex;flex-direction:column;gap:15px;margin-top:20px;max-width:800px;"]),k=i.Ay.div.withConfig({componentId:"sc-d657d38a-13"})(["background-color:#fff;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,0.1);padding:15px;transition:all 0.3s ease;&:hover{box-shadow:0 4px 8px rgba(0,0,0,0.15);transform:translateY(-2px);}"]),w=(0,i.Ay)(k).withConfig({componentId:"sc-d657d38a-14"})(["cursor:pointer;"]),_=i.Ay.h4.withConfig({componentId:"sc-d657d38a-15"})(["font-size:18px;font-weight:600;margin-bottom:10px;color:#333;"]),A=i.Ay.div.withConfig({componentId:"sc-d657d38a-16"})(["font-size:14px;color:#555;"]),S=i.Ay.button.withConfig({componentId:"sc-d657d38a-17"})(["background-color:#2196f3;color:white;padding:6px 12px;border:none;border-radius:4px;cursor:pointer;font-size:14px;margin-top:10px;&:hover{background-color:#0b7dda;}"]),I=i.Ay.button.withConfig({componentId:"sc-d657d38a-18"})(["background-color:#4caf50;color:white;padding:6px 12px;border:none;border-radius:4px;cursor:pointer;font-size:14px;margin-right:10px;"]),P=i.Ay.button.withConfig({componentId:"sc-d657d38a-19"})(["background-color:#f44336;color:white;padding:6px 12px;border:none;border-radius:4px;cursor:pointer;font-size:14px;"]),q=i.Ay.input.withConfig({componentId:"sc-d657d38a-20"})(["padding:8px;margin:5px 0;border:1px solid #ddd;border-radius:4px;width:100%;"]),D=i.Ay.div.withConfig({componentId:"sc-d657d38a-21"})(["display:flex;align-items:center;margin:5px 0;input{margin-right:8px;}"]),U=i.Ay.div.withConfig({componentId:"sc-d657d38a-22"})(["margin-top:15px;padding-top:15px;border-top:1px solid #eee;"]),z=i.Ay.div.withConfig({componentId:"sc-d657d38a-23"})(["display:flex;gap:10px;margin-top:15px;"]),F=(0,o.Uz)(d.j2.app,"asia-northeast3");function E(){let e=(0,c.useRouter)();d.j2.currentUser;let[t,s]=(0,n.useState)(!1),[i,E]=(0,n.useState)(null),[T,L]=(0,n.useState)("idle"),[N,R]=(0,n.useState)("links"),[G,M]=(0,n.useState)([]),[B,O]=(0,n.useState)([]),[J,K]=(0,n.useState)(!1),[Q,H]=(0,n.useState)(!1),[$,X]=(0,n.useState)({}),[Y,Z]=(0,n.useState)({}),[V,W]=(0,n.useState)(null),[ee,et]=(0,n.useState)(!1),[es,er]=(0,n.useState)(null),[en,ei]=(0,n.useState)("tech"),[eo,ed]=(0,n.useState)(!1),[ea,ec]=(0,n.useState)(!0),[el,ep]=(0,n.useState)(!1),eu=async()=>{K(!0);try{let e=(0,a.rJ)(d.db,"articles"),t=(await (0,a.GG)(e)).docs.map(e=>({id:e.id,...e.data()})).sort((e,t)=>{let s=e.timestamp?.toDate?.()?e.timestamp.toDate():new Date(0);return(t.timestamp?.toDate?.()?t.timestamp.toDate():new Date(0)).getTime()-s.getTime()});M(t)}catch(e){console.error("Error fetching articles:",e)}finally{K(!1)}},ex=async()=>{H(!0);try{let e=(0,a.rJ)(d.db,"users"),t=(await (0,a.GG)(e)).docs.map(e=>({id:e.id,...e.data()}));O(t),await eh(t.map(e=>e.id))}catch(e){console.error("Error fetching users:",e)}finally{H(!1)}},eh=async e=>{try{let t=(0,o.Qg)(F,"getUserDisplayNames"),s=(await t({userIds:e})).data;X(s.displayNames),Z(s.phoneNumbers)}catch(e){console.error("Error fetching user data:",e)}},eg=async()=>{s(!0),L("idle");try{let e=(0,o.Qg)(F,"testSendLinksToUsers"),t=await e();E(t.data),L("success"),console.log("Function result:",t.data)}catch(e){console.error("Error calling function:",e),E(e),L("error")}finally{s(!1)}},em=async()=>{ed(!0),L("idle");try{let e=(0,o.Qg)(F,"sendLinksToCategory"),t=await e({category:en,testMode:ea});E(t.data),L("success"),console.log("Function result:",t.data)}catch(e){console.error("Error calling function:",e),E(e),L("error")}finally{ed(!1)}},ef=e=>{W({id:e.id,name:e.name||"",cat_tech:e.cat_tech||!1,cat_business:e.cat_business||!1}),er(null)},eb=()=>{W(null),er(null)},ej=async()=>{if(V){et(!0),er(null);try{let e=(0,a.H9)(d.db,"users",V.id);await (0,a.mZ)(e,{name:V.name,cat_tech:V.cat_tech,cat_business:V.cat_business}),O(B.map(e=>e.id===V.id?{...e,...V}:e)),W(null)}catch(e){console.error("Error updating user:",e),er("Failed to update user. Please try again.")}finally{et(!1)}}},ey=e=>{if(!V)return;let{name:t,value:s,type:r,checked:n}=e.target;W(e=>e?"checkbox"===r?{...e,[t]:n}:{...e,[t]:s}:e)};return el?(0,r.jsxs)(l,{children:[(0,r.jsx)(p,{children:"Admin Panel"}),(0,r.jsxs)(m,{children:[(0,r.jsx)(f,{active:"links"===N,onClick:()=>R("links"),children:"Send Links"}),(0,r.jsx)(f,{active:"articles"===N,onClick:()=>R("articles"),children:"Articles"}),(0,r.jsx)(f,{active:"users"===N,onClick:()=>R("users"),children:"Users"})]}),(0,r.jsxs)("div",{style:{width:"100%"},children:["links"===N&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(b,{children:[(0,r.jsx)(j,{children:"Test Send to All Users"}),(0,r.jsx)(u,{onClick:eg,disabled:t,children:t?"Sending...":"Test Send Links to Users"})]}),(0,r.jsxs)(b,{children:[(0,r.jsx)(j,{children:"Send to Specific Category"}),(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"15px"},children:[(0,r.jsxs)(y,{value:en,onChange:e=>ei(e.target.value),children:[(0,r.jsx)("option",{value:"tech",children:"Tech"}),(0,r.jsx)("option",{value:"business",children:"Business"})]}),(0,r.jsxs)(D,{style:{margin:"0 15px"},children:[(0,r.jsx)("input",{type:"checkbox",checked:ea,onChange:e=>ec(e.target.checked),id:"testModeCheckbox"}),(0,r.jsx)("label",{htmlFor:"testModeCheckbox",style:{marginLeft:"8px"},children:"Test Mode (only test users)"})]}),(0,r.jsx)(u,{onClick:em,disabled:eo,children:eo?"Sending...":`Send to ${en} subscribers`})]})]}),i&&(0,r.jsxs)(x,{children:[(0,r.jsx)(h,{children:"Function Result:"}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Status:"})," ",i.success?"Success":"Failed"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Message:"})," ",i.message]}),(0,r.jsx)(g,{status:T,children:"success"===T?"Successfully sent messages!":"error"===T?"Error sending messages":""}),i&&i.stats?"techCount"in i.stats||"businessCount"in i.stats?(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{children:["Tech recipients: ",i.stats.techCount||0]}),(0,r.jsxs)("p",{children:["Business recipients: ",i.stats.businessCount||0]}),(0,r.jsxs)("p",{children:["Expiry notifications: ",i.stats.expiryCount||0]})]}):"recipientCount"in i.stats?(0,r.jsx)("div",{children:(0,r.jsxs)("p",{children:[en.charAt(0).toUpperCase()+en.slice(1)," ","recipients: ",i.stats.recipientCount]})}):(0,r.jsx)("pre",{children:JSON.stringify(i.stats,null,2)}):null,(0,r.jsx)("div",{style:{marginTop:"15px"},children:(0,r.jsxs)("details",{children:[(0,r.jsx)("summary",{children:"Response Details"}),(0,r.jsx)("pre",{style:{maxHeight:"250px",overflow:"auto"},children:JSON.stringify(i,null,2)})]})})]})]}),"articles"===N&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u,{onClick:eu,disabled:J,children:J?"Loading...":"Refresh Articles"}),J?(0,r.jsx)("p",{children:"Loading articles..."}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(h,{children:["Articles (",G.length,")"]}),(0,r.jsx)(C,{children:G.map(t=>(0,r.jsxs)(w,{onClick:()=>{e.push(`/article/${t.id}`)},children:[(0,r.jsx)(_,{children:t.title?.english||"Untitled"}),(0,r.jsxs)(A,{children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"ID:"})," ",t.id]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Korean Title:"})," ",t.title?.korean||"No Korean title"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Date:"})," ",t.timestamp?.toDate?.()?t.timestamp.toDate().toLocaleDateString():"No date"]})]})]},t.id))})]})]}),"users"===N&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u,{onClick:ex,disabled:Q,children:Q?"Loading...":"Refresh Users"}),Q?(0,r.jsx)("p",{children:"Loading users..."}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(h,{children:["Users (",B.length,")"]}),(0,r.jsx)(v,{children:B.map(e=>{let t=$[e.id]||"",s=Y[e.id]||"",n=V?.id===e.id;return(0,r.jsxs)(k,{children:[(0,r.jsx)(_,{children:t||e.display_name||"Unnamed User"}),(0,r.jsxs)(A,{children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"ID:"})," ",e.id]}),s&&(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Phone:"})," ",s]}),e.phone&&(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Firestore Phone:"})," ",e.phone]}),e.email&&(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Email:"})," ",e.email]}),n?(0,r.jsxs)(U,{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{children:"Name:"}),(0,r.jsx)(q,{type:"text",name:"name",value:V.name,onChange:ey})]}),(0,r.jsxs)(D,{children:[(0,r.jsx)("input",{type:"checkbox",name:"cat_tech",checked:V.cat_tech,onChange:ey,id:"cat_tech"}),(0,r.jsx)("label",{htmlFor:"cat_tech",children:"Tech Category"})]}),(0,r.jsxs)(D,{children:[(0,r.jsx)("input",{type:"checkbox",name:"cat_business",checked:V.cat_business,onChange:ey,id:"cat_business"}),(0,r.jsx)("label",{htmlFor:"cat_business",children:"Business Category"})]}),es&&(0,r.jsx)("p",{style:{color:"red"},children:es}),(0,r.jsxs)(z,{children:[(0,r.jsx)(I,{onClick:ej,disabled:ee,children:ee?"Saving...":"Save"}),(0,r.jsx)(P,{onClick:eb,disabled:ee,children:"Cancel"})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Name:"})," ",e.name||"N/A"]}),e.cat_tech&&(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Category:"})," Tech"]}),e.cat_business&&(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Category:"})," Business"]}),e.last_received&&(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Last Received:"})," ",e.last_received.toDate().toLocaleString()]}),e.received_articles&&e.received_articles.length>0&&(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Received Articles:"})," ",e.received_articles.length]}),(0,r.jsx)(S,{onClick:()=>ef(e),children:"Edit User"})]})]})]},e.id)})})]})]})]})]}):(0,r.jsx)(l,{children:(0,r.jsx)(p,{children:"Loading..."})})}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73496:e=>{"use strict";e.exports=require("http2")},74075:e=>{"use strict";e.exports=require("zlib")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},96885:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});let r=(0,s(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/kylekim/Desktop/one_cup_eng/app/(main)/admin/AdminClient.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/kylekim/Desktop/one_cup_eng/app/(main)/admin/AdminClient.tsx","default")}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[57,814,440],()=>s(7250));module.exports=r})();